# 5. Check MySQL service status and configuration
- name: Check MySQL service status
  command: systemctl status mysqld
  register: mysql_status

- name: Stop MySQL service if running
  command: systemctl stop mysqld
  when: mysql_status.rc == 0

- name: Update MySQL configuration to restrict to root
  lineinfile:
    path: /etc/my.cnf
    regexp: '^user='
    line: 'user=root'
  notify: restart mysql

- name: Start MySQL service
  command: systemctl start mysqld
